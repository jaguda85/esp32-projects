---
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
    const projects = await import.meta.glob('../../projects/*.md');
    
    const paths = await Promise.all(
        Object.keys(projects).map(async (path) => {
            const project = await projects[path]();
            return {
                params: { slug: project.frontmatter.slug },
                props: { project },
            };
        })
    );
    
    return paths;
}

const { project } = Astro.props;
const { Content } = project;
---

<Layout title={project.frontmatter.title}>
    <a href="/" class="back-link">‚Üê Powr√≥t do projekt√≥w</a>
    
    <article class="project-detail">
        <h1>{project.frontmatter.title}</h1>
        
        {project.frontmatter.image && (
            <img src={project.frontmatter.image} alt={project.frontmatter.title} class="main-image" />
        )}
        
        <div class="content">
            <Content />
        </div>
        
        {project.frontmatter.codeFile && (
            <a href={project.frontmatter.codeFile} class="download-btn" download>
                üì• Pobierz plik .ino
            </a>
        )}
    </article>
</Layout>

<style>
    .back-link {
        display: inline-block;
        margin-bottom: 20px;
        color: #667eea;
        text-decoration: none;
        font-weight: bold;
        transition: color 0.3s;
    }
    
    .back-link:hover {
        color: #5568d3;
        text-decoration: underline;
    }

    .project-detail {
        max-width: 100%;
    }
    
    .main-image {
        width: 100%;
        max-height: 400px;
        object-fit: cover;
        border-radius: 15px;
        margin: 20px 0;
        box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }
    
    .content {
        line-height: 1.8;
        color: #333;
    }
    
    .content :global(h2) {
        color: #667eea;
        margin-top: 35px;
        margin-bottom: 15px;
        font-size: 1.8rem;
    }

    .content :global(h3) {
        color: #764ba2;
        margin-top: 25px;
        margin-bottom: 12px;
        font-size: 1.4rem;
    }
    
    .content :global(ul) {
        margin-left: 25px;
        margin-bottom: 20px;
    }

    .content :global(li) {
        margin-bottom: 8px;
    }

    .content :global(code) {
        background: #f4f4f4;
        padding: 2px 6px;
        border-radius: 3px;
        font-family: 'Courier New', monospace;
        font-size: 0.9em;
    }

    .content :global(pre) {
        background: #2d2d2d;
        color: #f8f8f2;
        padding: 20px;
        border-radius: 8px;
        overflow-x: auto;
        margin: 20px 0;
    }

    .content :global(pre code) {
        background: transparent;
        padding: 0;
        color: inherit;
    }
    
    .download-btn {
        display: inline-block;
        margin-top: 40px;
        padding: 15px 35px;
        background: #28a745;
        color: white;
        text-decoration: none;
        border-radius: 10px;
        font-weight: bold;
        font-size: 16px;
        transition: all 0.3s;
        box-shadow: 0 4px 10px rgba(40, 167, 69, 0.3);
    }
    
    .download-btn:hover {
        background: #218838;
        transform: translateY(-2px);
        box-shadow: 0 6px 15px rgba(40, 167, 69, 0.4);
    }
</style>